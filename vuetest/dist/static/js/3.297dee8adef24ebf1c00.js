webpackJsonp([3],{JJ7H:function(t,e){},WK43:function(t,e){},ia7Y:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("oVO8"),o={data:function(){return{rules:{name:[{required:!0,message:"请输入姓名",trigger:"change"}],account:[{required:!0,message:"请输入账号",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"change"}],rule:[{required:!0,message:"请选择权限",trigger:"change"}]},tableData:[],form:{name:"",account:"",password:"",rule:""},options:[],showForm:!1,edit:!1,ruleName:"",title:""}},props:["dialogForm","info"],mounted:function(){this.showForm=this.dialogForm,this.title="添加账号",this.info&&(this.edit=!0,this.form.name=this.info.name,this.ruleName=this.info.rule_name,this.title="编辑"),this.init()},methods:{init:function(){var t=this;this.$http.get(n.a+"/api/Rule/ruleList").then(function(e){200==e.data.code?t.options=e.data.data.ruleList:t.$alert(e.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})}).catch(function(e){t.$alert(e,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})},cancel:function(){this.$emit("close","close")},submitForm:function(t){var e=this;if(!this.form.name)return this.$alert("请输入姓名","温馨提示",{confirmButtonText:"确定",callback:function(){}}),!1;if(this.edit){var a={rule_id:this.ruleName>0?this.ruleName:this.info.rule_id,name:this.form.name};this.$emit("close","ok",a,"edit",this.info.id)}else{if(this.form.rule=this.ruleName,!this.form.account)return this.$alert("请输入账户","温馨提示",{confirmButtonText:"确定",callback:function(){}}),!1;if(!this.form.password)return this.$alert("请输入密码","温馨提示",{confirmButtonText:"确定",callback:function(){}}),!1;if(!this.form.rule)return this.$alert("请选择权限","温馨提示",{confirmButtonText:"确定",callback:function(){}}),!1;this.$refs[t].validate(function(t){if(!t)return!1;e.tableData.push(e.form),e.tableData[0].password.length<6?e.$alert("密码长度不能小于6","温馨提示",{confirmButtonText:"确定",callback:function(){}}):e.$emit("close","ok",e.tableData,"add")})}},close:function(){this.$emit("close","close")}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.title,visible:t.showForm},on:{"update:visible":function(e){t.showForm=e},close:t.close}},[a("el-form",{ref:"form",staticClass:"ruleForm",attrs:{model:t.form,"label-width":"75px"}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),t.edit?t._e():a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{model:{value:t.form.account,callback:function(e){t.$set(t.form,"account",e)},expression:"form.account"}})],1),t._v(" "),t.edit?t._e():a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"权限"}},[a("el-select",{staticStyle:{width:"325px"},attrs:{placeholder:"请选择职位"},model:{value:t.ruleName,callback:function(e){t.ruleName=e},expression:"ruleName"}},t._l(t.options,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id+""}})}))],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("form")}}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var r={data:function(){return{tableData:[],dialogForm:!1,loading:!0,page:1,total:1,info:"",list:[]}},components:{user:a("VU/8")(o,i,!1,function(t){a("JJ7H")},"data-v-3656309c",null).exports},created:function(){this.getList()},methods:{edit:function(t){this.dialogForm=!0,this.info=t},handleClick:function(t){var e=this;this.$confirm("此操作将永久删除该账户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.out(t)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},currentChange:function(t){console.log(t),this.tableData=this.list.slice(50*(t-1),50*t)},getList:function(){var t=this;this.$http.get(n.a+"/api/user/accountList").then(function(e){200==e.data.code?(t.list=e.data.data.list,t.total=e.data.data.list.length,t.currentChange(1),t.loading=!1):t.$alert(e.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})}).catch(function(e){t.$alert(e,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})},add:function(){this.dialogForm=!0,this.info=""},dialog:function(t,e,a,o){var i=this;this.dialogForm=!1,"ok"==t&&"add"==a&&this.$http.post(n.a+"/api/user/addAccount",{name:e[0].name,rule_id:e[0].rule,email:e[0].account,password:e[0].password}).then(function(t){200==t.data.code?(i.getList(),i.$message({type:"success",message:"添加成功！"})):i.$alert(t.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})}),"ok"==t&&"edit"==a&&this.$http.post(n.a+"/api/user/editAccount",{account_id:o,operate:"setRule",param:e.rule_id,name:e.name}).then(function(t){200==t.data.code?(i.$message({type:"success",message:"修改成功！"}),i.getList()):i.$alert(t.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})},out:function(t){var e=this;this.$http.get(n.a+"/api/user/delAccount?account_id="+t).then(function(t){200==t.data.code?(e.getList(),e.$message({type:"success",message:"删除成功！"})):e.$alert(t.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})},reset:function(t){var e=this;this.$confirm("是否确认重置密码?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(n.a+"/api/user/editAccount",{account_id:t,operate:"resetPassword",param:""}).then(function(t){200==t.data.code?e.$message({type:"success",message:"重置成功！"}):e.$alert(t.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})}).catch(function(){e.$message({type:"info",message:"已取消操作"})})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account",staticStyle:{"max-width":"1202px"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("添加账号")]),t._v(" "),t.dialogForm?a("user",{attrs:{info:t.info,dialogForm:t.dialogForm},on:{close:t.dialog}}):t._e(),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"max-width":"1202px","margin-top":"20px"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"name",label:"姓名",align:"center"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"email",label:"账号",align:"center"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"rule_name",label:"权限",align:"center"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(a){t.handleClick(e.row.id)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.edit(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.reset(e.row.id)}}},[t._v("重置密码")])]}}])})],1),t._v(" "),t.total?a("el-pagination",{staticClass:"page",attrs:{background:"",layout:"prev, pager, next","page-size":50,total:t.total},on:{"current-change":t.currentChange}}):t._e()],1)},staticRenderFns:[]};var l=a("VU/8")(r,s,!1,function(t){a("iomx"),a("WK43")},"data-v-58ab80b8",null);e.default=l.exports},iomx:function(t,e){}});
//# sourceMappingURL=3.297dee8adef24ebf1c00.js.map