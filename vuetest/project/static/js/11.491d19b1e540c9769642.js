webpackJsonp([11],{oKJk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("oVO8"),n={data:function(){return{dialogImageUrl:"",dialogVisible:!1,list:[],loginImg:"",imgHost:""}},mounted:function(){this.init(),this.imgHost=i.a},methods:{init:function(){var t=this;this.$http.get(i.a+"/api/image/getList").then(function(e){if(200==e.data.code){t.list=e.data.data;for(var a=0;a<t.list.length;a++)t.list[a].thumb=t.imgHost+"/"+t.list[a].url;t.list.filter(function(e){1==e.is_cover&&(t.loginImg=e.thumb)}),t.loginImg||t.$http.get(i.a+"/api/Login/getCoverUrl").then(function(e){200==e.data.code?t.loginImg=t.imgHost+"/"+e.data.data:t.$alert(e.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})}else t.$alert(e.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})},setCover:function(t){var e=this;this.$http.get(i.a+"/api/image/setCover?id="+t).then(function(t){200==t.data.code?(e.init(),e.$message({type:"success",message:"设置成功！"})):e.$alert(t.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})},delImage:function(t){var e=this;this.$confirm("此操作将永久删除该照片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.delimg(t)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},delimg:function(t){var e=this;this.$http.get(i.a+"/api/image/delImage?id="+t).then(function(t){200==t.data.code?(e.init(),e.$message({type:"success",message:"删除成功！"})):e.$alert(t.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}})})},uploadPhoto:function(t){var e=this,a=new FormData;a.append("image",t.target.files[0]),a.append("access_token",sessionStorage.getItem("token"));var n=this.$http.create({withCredentials:!0}),s=this.$loading({text:"正在上传..."});n.post(i.a+"/api/Image/addImage",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){200==t.data.code?(e.$nextTick(function(){s.close()}),e.$message({type:"success",message:"上传成功！"}),e.init()):(e.$nextTick(function(){s.close()}),e.$alert(t.data.error,"温馨提示",{confirmButtonText:"确定",callback:function(){}}))})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"photo"},[a("div",{staticClass:"main"},[a("div",{staticClass:"default"},[a("img",{attrs:{src:t.loginImg,alt:""}})]),t._v(" "),a("div",{staticClass:"upload"},[a("input",{attrs:{name:"file",accept:"image/jpeg,image/png,image/image/tiff",type:"file"},on:{change:function(e){t.uploadPhoto(e)}}}),t._v(" "),a("el-button",{staticStyle:{width:"130px"},attrs:{type:"primary",size:"small"}},[t._v("上传照片")])],1)]),t._v(" "),t._l(t.list,function(e,i){return a("div",{key:i,staticClass:"img"},[a("img",{attrs:{src:e.url,alt:""}}),t._v(" "),a("div",{staticClass:"set"},[a("span",{on:{click:function(a){t.setCover(e.id)}}},[t._v("设为封面")]),a("span",{on:{click:function(a){t.delImage(e.id)}}},[t._v("删除")])])])})],2)},staticRenderFns:[]};var o=a("VU/8")(n,s,!1,function(t){a("pPB3")},"data-v-2007306e",null);e.default=o.exports},pPB3:function(t,e){}});
//# sourceMappingURL=11.491d19b1e540c9769642.js.map